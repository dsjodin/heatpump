# IVT Greenline Heat Pump Profile
# For use with H66 Gateway
# Reference: https://online.husdata.se/h-docs/C00.pdf (IVT Rego 600/637)

metadata:
  name: "IVT Greenline"
  manufacturer: "IVT"
  model: "Greenline"
  pump_type: "ground_source"
  description: "IVT Greenline bergvärmepump med Rego 600/637 styrsystem"

# Brand-specific capabilities
capabilities:
  has_power_measurement: false       # Saknar CFAA/5FAB (kan ej mäta effekt direkt)
  has_heat_carrier_sensors: true     # Har 0003/0004 (interna sensorer)
  has_external_tank_sensor: true     # Har 000A (extern tank)
  has_separate_heater_steps: true    # Har 1A02/1A03 (3kW/6kW steps)
  has_detailed_runtime: true         # Har 6C55/6C56 (heating/hotwater separat)
  has_cooling: false                 # Saknar 0013/0214
  has_pressure_tube_temp: false      # Saknar 0012, men har 000B (hot gas)

# Register definitions
registers:
  # ==================== TEMPERATURER ====================
  "0001":
    name: "radiator_return"
    unit: "°C"
    type: "temperature"
    description: "Return water feed from radiators [if installed]"
  
  "0002":
    name: "radiator_forward"
    unit: "°C"
    type: "temperature"
    description: "Water feed out to radiators"
  
  "0003":
    name: "heat_carrier_return"
    unit: "°C"
    type: "temperature"
    description: "HP internal heat carrier return"
  
  "0004":
    name: "heat_carrier_forward"
    unit: "°C"
    type: "temperature"
    description: "HP internal heat supply forward"
  
  "0005":
    name: "brine_in_evaporator"
    unit: "°C"
    type: "temperature"
    description: "Supply in from ground source for LW pumps, Evaporator for AW pumps"
  
  "0006":
    name: "brine_out_condenser"
    unit: "°C"
    type: "temperature"
    description: "Supply out to ground source for LW pumps, Condenser for AW pumps"
  
  "0007":
    name: "outdoor_temp"
    unit: "°C"
    type: "temperature"
    description: "Outdoor sensor"
  
  "0008":
    name: "indoor_temp"
    unit: "°C"
    type: "temperature"
    description: "Temp of indoor sensor [if installed]"
  
  "0009":
    name: "hot_water_top"
    unit: "°C"
    type: "temperature"
    description: "Warm water tank temp GT3 (For internal Tank)"
  
  "000A":
    name: "hot_water_mid"
    unit: "°C"
    type: "temperature"
    description: "Warm water tank temp GT3X (For external tank if installed)"
  
  "000B":
    name: "hot_gas_temp"
    unit: "°C"
    type: "temperature"
    description: "Hot gas from compressor before expansion valve"
  
  "0107":
    name: "heating_setpoint"
    unit: "°C"
    type: "temperature"
    description: "Target temp for heating"
  
  "0111":
    name: "hot_water_setpoint"
    unit: "°C"
    type: "temperature"
    description: "Target temp for warm tap water"

  # ==================== PUMP SPEEDS ====================
  # IVT does not have variable speed pumps in standard config

  # ==================== PUMP STATUSES ====================
  "1A01":
    name: "compressor_status"
    unit: ""
    type: "status"
    description: "Compressor 0=Off, 1=On"
  
  "1A02":
    name: "aux_heater_step1_status"
    unit: ""
    type: "status"
    description: "Add heat step 1. 0=Off, 1=On. Normally 3kW step"
  
  "1A03":
    name: "aux_heater_step2_status"
    unit: ""
    type: "status"
    description: "Add heat step 2. 0=Off, 1=On. Normally 6kW step"
  
  "1A04":
    name: "brine_pump_status"
    unit: ""
    type: "status"
    description: "Ground source pump. 0=Off, 1=On (LW pumps only)"
  
  "1A05":
    name: "heat_circuit_pump_status"
    unit: ""
    type: "status"
    description: "Internal circulation pump. 0=Off, 1=On"
  
  "1A06":
    name: "radiator_pump_status"
    unit: ""
    type: "status"
    description: "Radiator pump. 0=Off, 1=On"
  
  "1A07":
    name: "switch_valve_status"
    unit: ""
    type: "status"
    description: "Switch valve position 0=Radiator heating, 1=Hot Water heating"

  # ==================== ALARM ====================
  "1A20":
    name: "alarm_status"
    unit: ""
    type: "alarm"
    description: "Pump alarm. >0 = Alarming"
  
  "BA91":
    name: "alarm_code"
    unit: ""
    type: "alarm"
    description: "Number of the last trigged alarm, even of no active alarm now"

  # ==================== SETTINGS ====================
  "0203":
    name: "room_temp_setpoint"
    unit: "°C"
    type: "temperature"
    description: "Set room temp if Indoor sensor [if installed]"
  
  "2204":
    name: "room_sensor_influence"
    unit: "°C"
    type: "setting"
    description: "Set how much room temp should influence heating (if Indoor sensor installed)"
  
  "2205":
    name: "heat_curve_L"
    unit: "°C"
    type: "setting"
    description: "Set heat curve level"
  
  "0207":
    name: "heat_curve_parallel"
    unit: "°C"
    type: "setting"
    description: "Set heat curve parallel offset"
  
  "0208":
    name: "hot_water_stop_temp"
    unit: "°C"
    type: "temperature"
    description: "Set stop temp for tap hot water (too high will trigger Pressostat alarm)"
  
  "020B":
    name: "hot_water_diff_temp"
    unit: "°C"
    type: "temperature"
    description: "Set tap water start threshold: WW Stop temp-Diff temp = WW start temp"
  
  "7209":
    name: "extra_hot_water_minutes"
    unit: "minutes"
    type: "setting"
    description: "Set minutes for the Extra warm water feature to be activated"
  
  "1215":
    name: "heater_switch"
    unit: ""
    type: "setting"
    description: "1=on, 0=off. Turn off Electrical heater"
  
  "1233":
    name: "external_control"
    unit: ""
    type: "setting"
    description: "Activate external control input 1 to block HP operations. 1=Active, 0=Inactive"
  
  "020A":
    name: "summer_mode_temp"
    unit: "°C"
    type: "temperature"
    description: "Set temp where HP should go into summer mode and only produce Hot Water"
  
  "2210":
    name: "holiday_mode_hours"
    unit: "hours"
    type: "setting"
    description: "Set 0-30 days for holiday mode to be activated"
  
  "12F2":
    name: "alarm_reset"
    unit: ""
    type: "setting"
    description: "Set to 0 to execute a cycle that is turning off the pump for 10 seconds"

  # ==================== RUNTIME COUNTERS ====================
  "6C55":
    name: "compressor_runtime_heating"
    unit: "hours"
    type: "runtime"
    description: "Compressor runtime for heating"
  
  "6C56":
    name: "compressor_runtime_hotwater"
    unit: "hours"
    type: "runtime"
    description: "Compressor runtime for hot water production"
  
  "6C58":
    name: "aux_runtime_heating"
    unit: "hours"
    type: "runtime"
    description: "Electrical additional heater runtime for heating"
  
  "6C59":
    name: "aux_runtime_hotwater"
    unit: "hours"
    type: "runtime"
    description: "Electrical additional heater for hot water production"

  # ==================== CUSTOM REGISTERS ====================
  "025A":
    name: "heat_carrier_in_max"
    unit: "°C"
    type: "temperature"
    description: "Heat carrier in Max (90)"

# IVT-specific alarm codes (different from Thermia!)
alarm_codes:
  0: "Inget larm"
  1: "Sensor radiator return (GT1)"
  2: "Outdoor sensor (GT2)"
  3: "Sensor hot water (GT3)"
  4: "Mixing valve sensor (GT4)"
  5: "Room sensor (GT5)"
  6: "Sensor compressor (GT6)"
  7: "Sensor heat fluid out (GT8)"
  8: "Sensor heat fluid in (GT9)"
  9: "Sensor cold fluid in (GT10)"
  10: "Sensor cold fluid in (GT11)"
  11: "Compressor circuit switch"
  12: "Electrical cassette"
  13: "Pump circuit switch (MB2)"
  14: "Low pressure switch (LP)"
  15: "High pressure switch (HP)"
  16: "High return HP (GT9)"
  17: "Heat carrier out max (GT8)"
  18: "Brine in under limit (GT10)"
  19: "Brine out under limit (GT11)"
  20: "Compressor superheat (GT6)"
  21: "3-phase incorrect order"
  22: "Power failure"
  23: "Heat delta exceeded"
